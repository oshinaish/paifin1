<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MXDD3M82');</script>
<!-- End Google Tag Manager -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LRCM7PW2Y0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LRCM7PW2Y0');
</script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PaiFinance - Smart Strategy Tool</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Tailwind CSS configuration
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                        albert_sans: ['"Albert Sans"', 'sans-serif'],
                    },
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#6EE7B7',
                        background: '#F9FAFB',
                        card: '#FFFFFF',
                        textdark: '#1F2937',
                        textlight: '#4B5563',
                        danger: '#EF4444',
                        success: '#22C55E',
                        warning: '#F59E0B',
                        emi_purple: '#9a85e1',
                        investment_green: '#1B9272',
                        input_text_color: '#1B9272', 
                        seekbar_track_right: '#E5E7EB',
                        input_box_fill: '#53db9e',
                    },
                    boxShadow: {
                        'custom-input': '0px 0px 4px rgba(0, 0, 0, 0.04)',
                        'default': '0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)',
                    }
                }
            }
        }
    </script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Albert+Sans:wght@400;800&display=swap" rel="stylesheet">
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <style>
        /* Custom styles */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #EDF0EF; border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        input[type="number"] { -moz-appearance: textfield; }
        input[type="range"] { -webkit-appearance: none; appearance: none; height: 2px; background: #E5E7EB; outline: none; border-radius: 5px; }
        input[type="range"]::-webkit-slider-runnable-track { 
            width: 100%; 
            height: 2px; 
            background: linear-gradient(to right, rgba(27, 146, 114, 0.75) var(--range-progress, 0%), #E5E7EB var(--range-progress, 0%)); 
            border-radius: 5px; 
        }
        input[type="range"]::-webkit-slider-thumb { 
            -webkit-appearance: none; 
            appearance: none; 
            width: 14px; 
            height: 14px; 
            background: #f5f5fa; 
            border-radius: 50%; 
            cursor: grab; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.2); 
            margin-top: -6px; 
        }
        .goal-button { background-color: rgba(234, 234, 234, 0.2); color: #1F2937; }
        .goal-button.selected { background-color: #1B9272; color: #FFFFFF; box-shadow: 0 0 0 2px #1B9272, 0 0 0 4px rgba(27, 146, 114, 0.4); }
        .faq-answer { display: none; }
        .faq-question.open .chevron { transform: rotate(180deg); }
        
        @keyframes gradient-border {
            0% { border-color: #1B9272; }
            50% { border-color: #59e6ce; }
            100% { border-color: #1B9272; }
        }
        .animated-border {
            border: 2px solid;
            animation: gradient-border 3s linear infinite;
        }

        /* --- STYLES FOR ONBOARDING --- */
        .onboarding-step { display: none; }
        .onboarding-step.active { display: block; }
        .progress-bar-fill { transition: width 0.3s ease-in-out; }
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(27, 146, 114, 0.7); }
            50% { box-shadow: 0 0 0 12px rgba(27, 146, 114, 0); }
        }
        .animate-pulse-glow { animation: pulse-glow 2s infinite; }
    </style>
</head>
<body class="font-albert_sans bg-white text-textdark min-h-screen flex flex-col">

    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MXDD3M82"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<!-- Onboarding Modal (Initially Hidden) -->
<div id="onboardingModal" class="hidden fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center p-4 z-50">
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg transform transition-all relative">
        <!-- Close button -->
        <button id="closeOnboardingModal" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors z-10">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </button>
        <!-- Progress Bar -->
        <div class="p-6 border-b border-gray-200">
             <div class="flex justify-between items-center mb-2">
                <h2 id="onboardingTitle" class="text-xl font-bold text-textdark">Calculate Your Budget</h2>
                <span id="stepCounter" class="text-sm font-medium text-textlight">Step 1 of 3</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2.5">
                <div id="progressBar" class="bg-investment_green h-2.5 rounded-full" style="width: 33%"></div>
            </div>
        </div>
        <div class="p-8">
            <!-- Step 1: Income -->
            <div id="step1" class="onboarding-step active">
                <h3 class="text-2xl font-semibold text-textdark mb-2">Your Monthly Income</h3>
                <p class="text-textlight mb-6">Let's start with your earnings to understand your cash flow.</p>
                <div class="space-y-4">
                    <div>
                        <label for="ob_monthlyIncome" class="block text-sm font-medium text-textlight">Gross Monthly Salary (₹)</label>
                        <input type="number" id="ob_monthlyIncome" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-investment_green focus:border-investment_green" placeholder="e.g., 100000">
                    </div>
                    <div>
                        <label for="ob_epfVpf" class="block text-sm font-medium text-textlight">Monthly EPF/VPF Contribution (%)</label>
                        <input type="number" id="ob_epfVpf" value="12" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-investment_green focus:border-investment_green">
                    </div>
                </div>
                <button onclick="nextStep(2)" class="w-full mt-8 bg-investment_green text-white font-semibold py-3 px-4 rounded-lg hover:bg-opacity-90 transition">Next: Expenses</button>
            </div>
            <!-- Step 2: Expenses -->
            <div id="step2" class="onboarding-step">
                <h3 class="text-2xl font-semibold text-textdark mb-2">Your Lifestyle</h3>
                <p class="text-textlight mb-6">Understanding your expenses helps determine what's left for your goals.</p>
                 <div class="space-y-4">
                    <div>
                        <label for="ob_monthlyExpenses" class="block text-sm font-medium text-textlight">Monthly Household Expenses (₹)</label>
                        <input type="number" id="ob_monthlyExpenses" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-investment_green focus:border-investment_green" placeholder="e.g., 35000">
                    </div>
                </div>
                 <div class="flex justify-between mt-8 space-x-4">
                    <button onclick="prevStep(1)" class="w-1/3 bg-gray-200 text-gray-700 font-semibold py-3 px-4 rounded-lg hover:bg-gray-300 transition">Back</button>
                    <button onclick="nextStep(3)" class="w-2/3 bg-investment_green text-white font-semibold py-3 px-4 rounded-lg hover:bg-opacity-90 transition">Next: Your Goal</button>
                </div>
            </div>
            <!-- Step 3: Goal -->
            <div id="step3" class="onboarding-step">
                <h3 class="text-2xl font-semibold text-textdark mb-2">Your Financial Horizon</h3>
                <p class="text-textlight mb-6">How many years are you planning for? This helps in projecting long-term growth.</p>
                 <div class="space-y-4">
                    <div>
                        <label for="ob_planningYears" class="block text-sm font-medium text-textlight">Planning Horizon (Years)</label>
                        <input type="number" id="ob_planningYears" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-investment_green focus:border-investment_green" placeholder="e.g., 20">
                    </div>
                </div>
                 <div class="flex justify-between mt-8 space-x-4">
                     <button onclick="prevStep(2)" class="w-1/3 bg-gray-200 text-gray-700 font-semibold py-3 px-4 rounded-lg hover:bg-gray-300 transition">Back</button>
                    <button onclick="finishOnboarding()" class="w-2/3 bg-success text-white font-semibold py-3 px-4 rounded-lg hover:bg-opacity-90 transition">Calculate My Plan</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- NEW: Post-Onboarding Summary Modal -->
<div id="postOnboardingSummaryModal" class="hidden fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center p-4 z-50">
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg text-left p-8 transform transition-all relative">
        <!-- Close button -->
        <button id="closeSummaryModal" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors z-10">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </button>
        <h2 class="text-2xl font-bold text-textdark mb-4 text-center">Here's Your Starting Point!</h2>
        <div class="bg-background p-4 rounded-lg space-y-2 text-sm">
             <div class="flex justify-between items-center">
                <span class="text-textlight">Gross Monthly Salary</span>
                <span id="summaryGross" class="font-semibold text-textdark">₹0</span>
            </div>
            <div class="flex justify-between items-center">
                <span class="text-textlight">(-) Monthly Tax (est.)</span>
                <span id="summaryTax" class="font-semibold text-danger">- ₹0</span>
            </div>
            <div class="flex justify-between items-center">
                <span class="text-textlight">(-) EPF/VPF</span>
                <span id="summaryEpf" class="font-semibold text-danger">- ₹0</span>
            </div>
             <div class="flex justify-between items-center border-t pt-2 mt-2">
                <span class="text-textlight font-bold">In-Hand Salary</span>
                <span id="summaryInHand" class="font-bold text-textdark">₹0</span>
            </div>
            <div class="flex justify-between items-center">
                <span class="text-textlight">(-) Household Expenses</span>
                <span id="summaryExpenses" class="font-semibold text-danger">- ₹0</span>
            </div>
        </div>
        <div class="bg-green-50 p-4 rounded-lg mt-4">
            <div class="flex justify-between items-center">
                <span class="font-bold text-investment_green">Available Monthly Budget</span>
                <span id="summaryBudget" class="text-2xl font-bold text-investment_green">₹0</span>
            </div>
        </div>
        <p class="text-xs text-gray-400 mt-2 text-center">Tax is estimated using the old regime for simplicity.</p>
        <button id="startPlanningBtn" class="w-full mt-6 bg-investment_green text-white font-semibold py-3 px-4 rounded-lg hover:bg-opacity-90 transition">Start Planning &rarr;</button>
    </div>
</div>

<!-- Header Section -->
<header class="bg-card shadow-sm h-[68px] pl-[27px] pr-6 md:pr-8 flex items-center justify-between z-10 sticky top-0">
    <div class="flex items-center">
        <a href="./index.html">
            <img src="loogo.svg" alt="Pai Logo" class="h-8 w-auto">
        </a>
        <h1 class="text-xl font-extrabold text-textdark font-albert_sans ml-[22px]">Pai</h1>
    </div>
    
    <nav>
        <a href="./about.html" class="text-sm font-semibold text-textlight hover:text-investment_green transition-colors">About Us</a>
    </nav>
</header>

    <!-- Main Content Area -->
    <main class="flex-1 flex flex-col">
        <!-- Top Section: Inputs and Pie Chart -->
        <div class="grid grid-cols-1 lg:grid-cols-4">
            <!-- Left Side: Input & Calculation Section (3/4 width) -->
            <section class="lg:col-span-3 bg-card p-6">
                 <h2 class="text-[21px] font-normal text-textdark font-albert_sans mb-6">Smart Loan & Investment Planner</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12">
                    <!-- Column 1: Loan Details -->
                    <div class="space-y-5">
                        <div>
                            <div class="flex items-center justify-between w-full max-w-[330px]">
                                <label for="loanAmount" class="block text-sm font-normal text-textlight font-albert_sans">Loan Amount</label>
                                <div class="w-[114px] h-[29px] p-2 rounded-[2px] bg-input_box_fill bg-opacity-10 shadow-custom-input flex items-center">
                                    <span class="font-normal text-input_text_color pl-1">₹</span>
                                    <input type="number" id="loanAmount" value="5000000" min="100000" max="50000000" step="100000" class="w-full bg-transparent border-none focus:ring-0 text-input_text_color text-right p-0 m-0 font-albert_sans font-normal text-base">
                                </div>
                            </div>
                            <input type="range" id="loanAmountSlider" value="5000000" min="100000" max="50000000" step="100000" class="w-full max-w-[330px] mt-[18px]">
                        </div>
                    </div>
                    <!-- Column 2: Budget Details -->
                     <div class="space-y-5">
                          <div>
                            <div class="flex items-center justify-between w-full max-w-[330px]">
                                <label for="monthlyBudget" class="block text-sm font-normal text-textlight font-albert_sans">Monthly Budget</label>
                                <div class="flex items-center space-x-2">
                                     <div class="w-[114px] h-[29px] p-2 rounded-[2px] bg-input_box_fill bg-opacity-10 shadow-custom-input flex items-center">
                                        <span class="font-normal text-input_text_color pl-1">₹</span>
                                        <input type="number" id="monthlyBudget" value="70000" min="10000" max="1000000" step="1000" class="w-full bg-transparent border-none focus:ring-0 text-input_text_color text-right p-0 m-0 font-albert_sans font-normal text-base">
                                     </div>
                                     <!-- Onboarding Trigger Icon -->
                                    <button id="onboardingTriggerIcon" class="relative flex-shrink-0 group">
                                         <svg class="w-6 h-6 text-investment_green" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                                         
                                         <!-- Coachmark -->
                                         <div id="coachmark" class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-max z-20">
                                             <div class="relative bg-investment_green text-white text-sm font-semibold py-2 px-4 rounded-lg shadow-lg">
                                                First, let's calculate your budget!
                                                <div class="absolute left-1/2 -bottom-2 transform -translate-x-1/2 w-0 h-0 border-l-8 border-l-transparent border-r-8 border-r-transparent border-t-8 border-t-investment_green"></div>
                                             </div>
                                         </div>

                                         <!-- Hover Tooltip -->
                                         <div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-max z-20 hidden group-hover:block">
                                             <div class="relative bg-textdark text-white text-xs font-semibold py-1 px-3 rounded-md shadow-lg">
                                                Edit Manually
                                                <div class="absolute left-1/2 -bottom-1.5 transform -translate-x-1/2 w-0 h-0 border-l-4 border-l-transparent border-r-4 border-r-transparent border-t-4 border-t-textdark"></div>
                                             </div>
                                         </div>

                                          <!-- Pulsing Dot on Icon -->
                                          <span id="pulsingDot" class="absolute top-0 right-0 block h-3 w-3 rounded-full bg-investment_green"></span>
                                    </button>
                                </div>
                            </div>
                            <input type="range" id="monthlyBudgetSlider" value="70000" min="10000" max="1000000" step="1000" class="w-full max-w-[330px] mt-[18px]">
                        </div>
                    </div>
                </div>

                <!-- Strategy Box -->
                <div class="relative mt-12">
                    <!-- Goal Buttons Positioned on Top Edge -->
                    <div class="absolute -top-5 left-1/2 transform -translate-x-1/2 z-10">
                        <div class="flex flex-nowrap justify-center gap-4 bg-card p-2 rounded-[30px] shadow-md">
                            <button type="button" id="btnPlanner" data-goal="planner" class="goal-button selected flex flex-col items-center justify-center py-2 px-4 rounded-[25px] cursor-pointer transition-all duration-200 text-sm font-bold text-center shadow-sm font-albert_sans uppercase">Manual<br>Planner</button>
                            <button type="button" id="btnMinTime" data-goal="min-time" class="goal-button flex flex-col items-center justify-center py-2 px-4 rounded-[25px] cursor-pointer transition-all duration-200 text-sm font-bold text-center shadow-sm font-albert_sans uppercase">Minimum Time<br>to Offset</button>
                            <button type="button" id="btnOptimalStrategy" data-goal="optimal-strategy" class="goal-button flex flex-col items-center justify-center py-2 px-4 rounded-[25px] cursor-pointer transition-all duration-200 text-sm font-bold text-center shadow-sm font-albert_sans uppercase">Find Optimal<br>Strategy</button>
                        </div>
                    </div>
                    
                    <!-- Main Strategy Box Content -->
                    <div class="relative py-6 pt-12 bg-[rgba(234,234,234,0.25)] shadow-lg rounded-lg w-full">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12 px-6 mt-8">
                            <!-- Column 1: Loan Parameters -->
                            <div class="space-y-5">
                                <div>
                                    <div class="flex items-center justify-between w-full">
                                        <label for="loanInterestRateDisplay" class="block text-sm font-normal text-textlight font-albert_sans">Loan Interest Rate</label>
                                        <div class="w-[114px] h-[29px] p-2 rounded-[2px] bg-input_box_fill bg-opacity-10 shadow-custom-input flex items-center">
                                            <input type="number" id="loanInterestRateDisplay" value="8.5" min="1" max="20" step="0.1" class="w-full bg-transparent border-none focus:ring-0 text-input_text_color text-right p-0 m-0 font-albert_sans font-normal text-base">
                                            <span class="font-normal text-input_text_color pl-1">%</span>
                                        </div>
                                    </div>
                                    <input type="range" id="loanInterestRateSlider" value="8.5" min="1" max="20" step="0.1" class="w-full mt-[18px]">
                                </div>
                                <div id="loanTenureContainer">
                                    <div class="flex items-center justify-between w-full">
                                        <label class="block text-sm font-normal text-textlight font-albert_sans">Loan Tenure</label>
                                        <div class="w-[114px] h-[29px] p-2 rounded-[2px] bg-input_box_fill bg-opacity-10 shadow-custom-input flex items-center">
                                            <input type="number" id="loanTenureDisplay" value="30" min="1" max="30" class="w-full bg-transparent border-none focus:ring-0 text-input_text_color text-right p-0 m-0 font-albert_sans font-normal text-base">
                                            <span class="font-normal text-input_text_color pl-1">Yr</span>
                                        </div>
                                    </div>
                                    <input type="range" id="loanTenureSlider" value="30" min="1" max="30" class="w-full mt-[18px]">
                                </div>
                                <div class="flex items-center justify-between w-full">
                                    <label class="block text-sm font-normal text-textlight font-albert_sans">Monthly EMI</label>
                                    <div class="w-[114px] h-[29px] p-2 rounded-[2px] bg-input_box_fill bg-opacity-10 shadow-custom-input flex items-center justify-end">
                                        <p id="emiResult" class="w-full bg-transparent text-right p-0 m-0 font-albert_sans font-normal text-base text-emi_purple">₹ 0</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Column 2: Investment Parameters -->
                            <div class="space-y-5">
                                 <div>
                                    <div class="flex items-center justify-between w-full">
                                        <label for="investmentRateDisplay" class="block text-sm font-normal text-textlight font-albert_sans">Investment Return Rate</label>
                                        <div class="w-[114px] h-[29px] p-2 rounded-[2px] bg-input_box_fill bg-opacity-10 shadow-custom-input flex items-center">
                                            <input type="number" id="investmentRateDisplay" value="12" min="1" max="30" step="0.1" class="w-full bg-transparent border-none focus:ring-0 text-input_text_color text-right p-0 m-0 font-albert_sans font-normal text-base">
                                            <span class="font-normal text-input_text_color pl-1">%</span>
                                        </div>
                                    </div>
                                    <input type="range" id="investmentRateSlider" value="12" min="1" max="30" step="0.1" class="w-full mt-[18px]">
                                </div>
                                <div id="investmentTenureContainer">
                                    <div class="flex items-center justify-between w-full">
                                        <label for="investmentTenureDisplay" class="block text-sm font-normal text-textlight font-albert_sans">Investment Tenure</label>
                                        <div class="w-[114px] h-[29px] p-2 rounded-[2px] bg-input_box_fill bg-opacity-10 shadow-custom-input flex items-center">
                                            <input type="number" id="investmentTenureDisplay" value="30" min="1" max="30" class="w-full bg-transparent border-none focus:ring-0 text-input_text_color text-right p-0 m-0 font-albert_sans font-normal text-base">
                                            <span class="font-normal text-input_text_color pl-1">Yr</span>
                                        </div>
                                    </div>
                                    <input type="range" id="investmentTenureSlider" value="30" min="1" max="30" class="w-full mt-[18px]">
                                </div>
                                <div class="flex items-center justify-between w-full">
                                    <label class="block text-sm font-normal text-textlight font-albert_sans">Monthly Investment</label>
                                     <div class="w-[114px] h-[29px] p-2 rounded-[2px] bg-input_box_fill bg-opacity-10 shadow-custom-input flex items-center justify-end">
                                        <p id="monthlyInvestmentResult" class="w-full bg-transparent text-right p-0 m-0 font-albert_sans font-normal text-base text-investment_green">₹ 0</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Right Side: Pie Chart & Summary Section (1/4 width) -->
            <section class="lg:col-span-1 bg-card p-6 flex flex-col items-center justify-center space-y-6">
                 <div id="chartsContainer" class="w-full max-w-[350px]">
                    <div class="w-full h-[200px] relative">
                        <canvas id="monthlyBudgetChart"></canvas>
                        <div id="chartMessage" class="absolute inset-0 flex items-center justify-center text-center text-textlight p-4">
                            Your budget breakdown will appear here.
                        </div>
                    </div>
                 </div>
                 <div id="summaryResultsContainer" class="w-full max-w-[350px] bg-background p-4 rounded-lg shadow-inner hidden">
                    <!-- Summary results will be injected here -->
                 </div>
            </section>
        </div>

        <!-- Bottom Section: Full-Width Final Results -->
     <section id="finalResultsSection" class="bg-background p-6 hidden">
         <div id="mainResultsContainer" class="max-w-7xl mx-auto">
             <!-- Result widgets will be injected here by JavaScript -->
         </div>
         
         <div id="paiVsTraditionalContainer" class="max-w-7xl mx-auto mt-8 bg-card p-4 rounded-lg shadow-default hidden grid grid-cols-1 lg:grid-cols-3 gap-12 items-start">
             <div class="lg:col-span-2 h-[400px]">
                 <canvas id="paiVsTraditionalChart"></canvas>
             </div>
             <div id="paiVsTraditionalExplanation" class="lg:col-span-1 text-base text-textlight leading-relaxed">
                 <!-- Dynamic explanation will go here -->
             </div>
         </div>

         <div id="comparisonChartContainer" class="max-w-7xl mx-auto mt-8 bg-card p-4 rounded-lg shadow-default hidden grid grid-cols-1 lg:grid-cols-3 gap-12 items-start">
             <div id="chartExplanation" class="lg:col-span-1 text-base text-textlight leading-relaxed">
                 <!-- Dynamic explanation will go here -->
             </div>
             <div class="lg:col-span-2 h-[400px]">
                 <canvas id="comparisonChart"></canvas>
             </div>
         </div>

         <div id="amortizationContainer" class="max-w-7xl mx-auto mt-8 bg-card p-4 rounded-lg shadow-default hidden grid grid-cols-1 lg:grid-cols-3 gap-12 items-start">
             <div id="amortizationTableContainer" class="lg:col-span-2 h-[400px] overflow-y-auto">
                 <!-- Amortization table will be injected here -->
             </div>
             <div id="amortizationExplanation" class="lg:col-span-1 text-base text-textlight leading-relaxed">
                 <!-- Dynamic explanation will go here -->
             </div>
         </div>
     </section>

     <!-- SEO Content Sections -->
     <section class="bg-white p-6 md:p-12">
         <div class="w-full md:w-3/5 space-y-12">
             
             <div>
                 <h2 class="text-[21px] font-normal text-textdark font-albert_sans mb-4">How to Use the PaiFinance Calculator</h2>
                 <p class="text-textlight">Using our tool is simple. Just follow these steps to get a clear picture of your financial future:</p>
                 <ol class="list-decimal list-inside text-textlight space-y-2 mt-2">
                     <li>Enter your desired <strong>Loan Amount</strong> and your total <strong>Monthly Budget</strong> for both loan and investment payments.</li>
                     <li>Select one of the three goals: <strong>Manual Planner</strong>, <strong>Minimum Time to Offset</strong>, or <strong>Find Optimal Strategy</strong>.</li>
                     <li>Adjust the sliders for the <strong>Loan Interest Rate</strong> and your expected <strong>Investment Return Rate</strong>.</li>
                     <li>Instantly see your results, including a detailed breakdown of your payments, charts, and a full amortization schedule.</li>
                 </ol>
             </div>

             <div>
                 <h2 class="text-[21px] font-normal text-textdark font-albert_sans mb-4">Formula to Determine Lending and Investment</h2>
                 <p class="text-textlight mb-4">Our calculator uses industry-standard financial formulas to provide you with accurate projections. The <strong>Equated Monthly Installment (EMI)</strong> is calculated using the following formula:</p>
                 <div class="my-4 text-center text-lg">
                    <p class="text-textdark">EMI = [P &times; R &times; (1 + R)<sup>N</sup>] / [(1 + R)<sup>N</sup> - 1]</p>
                 </div>
                 <p class="text-textlight">Where P is the Principal Loan Amount, R is the monthly interest rate, and N is the number of months (tenure). Your investment growth is calculated using the standard <strong>future value of a Systematic Investment Plan (SIP)</strong> formula.</p>
             </div>

             <div>
                 <h2 class="text-[21px] font-normal text-textdark font-albert_sans mb-4">How Does the Calculator Help You Manage Your Finances?</h2>
                 <p class="text-textlight">The PaiFinance calculator is more than just a tool; it's a strategic partner. It helps you move beyond simply paying off a loan and empowers you to build wealth simultaneously. By visualizing the impact of different strategies, you can make informed decisions that align with your financial goals, whether that's becoming debt-free as fast as possible or maximizing your long-term wealth.</p>
             </div>

             <div>
                 <h2 class="text-[21px] font-normal text-textdark font-albert_sans mb-4">Types Of EMI Calculators Offered by Pai Finance</h2>
                 <div class="space-y-4 text-textlight">
                     <p>At Pai Finance, we believe that effective loan repayment should be complemented by smart investment planning. Our EMI calculators not only estimate your monthly installments but also help you discover how disciplined parallel investing can reduce your overall interest burden and grow your wealth. Whether you're planning to buy a home, a car, a bike, fund education, or leverage your property, Pai Finance offers tailored EMI calculators for every need.</p>
                     <br>
                     <a href="./home-loan-calculator.html">
                        <h3 class="font-semibold text-investment_green hover:underline">Home Loan EMI Calculator</h3>
                     </a>
                     <p>Home loans involve high principal amounts and long repayment periods. The Home Loan EMI Calculator helps you instantly calculate your EMI based on loan amount, tenure, and interest rate. Unlike basic calculators, Pai Finance also guides you on how much you can invest each month to gradually offset your loan interest—making your home loan work smarter for you.</p>
                     <br>
                     <a href="./car-loan-calculator.html">
                        <h3 class="font-semibold text-investment_green hover:underline">Car Loan EMI Calculator</h3>
                     </a>
                     <p>Car loans are a popular financing option for a major lifestyle purchase. The Car Loan EMI Calculator allows you to assess your repayment capability with clarity. More importantly, Pai Finance suggests how you can invest a portion of your remaining monthly budget to recover the interest paid over time, making your car an asset, not a liability.</p>
                     <h3 class="font-semibold text-investment_green">Bike Loan EMI Calculator</h3>
                     <p>Two-wheelers are one of the most common forms of transport in India, and bike loans are often short-tenured with moderate interest rates. The Bike Loan EMI Calculator helps you calculate the monthly outflow based on the loan amount, interest rate, and tenure. Pai Finance takes it a step further by helping you plan micro-investments alongside your EMIs, ensuring you stay financially efficient while paying off your bike loan.</p>
                     <h3 class="font-semibold text-investment_green">Personal Loan EMI Calculator</h3>
                     <p>Personal loans are often taken for weddings, medical needs, or unplanned expenses. The Personal Loan EMI Calculator quickly estimates your monthly repayment while allowing you to explore how parallel investments—even over a short period—can ease your overall financial burden and reduce effective interest costs.</p>
                     <h3 class="font-semibold text-investment_green">Education Loan EMI Calculator</h3>
                     <p>Education loans help families finance domestic and international studies. With the Education Loan EMI Calculator, you can plan repayments starting after the moratorium period. Pai Finance helps you take control early by starting investments even before repayment begins—setting you up for a smoother financial transition once the EMIs start.</p>
                     <h3 class="font-semibold text-investment_green">Loan Against Property EMI Calculator</h3>
                     <p>Loans against residential, commercial, or land property require precise planning. The Loan Against Property EMI Calculator provides an accurate estimate of your repayment. In addition, Pai Finance shows how to allocate part of your budget to investments that grow over time—ensuring liquidity and stability during repayment.</p>
                     <h3 class="font-semibold text-investment_green">Why Choose Pai Finance EMI Calculators?</h3>
                     <p>Most EMI calculators show only what you owe. Pai Finance goes further by helping you plan investments that run in parallel with your repayments. This dual approach empowers you to take loans with confidence—knowing that you're also building wealth alongside.</p>
                     <p>Whether you're financing a home, car, bike, education, or personal need, Pai Finance provides clarity, control, and a smarter path toward financial freedom.</p>
                 </div>
             </div>

             <div>
                 <h2 class="text-[21px] font-normal text-textdark font-albert_sans mb-4">Advantages of Using the Pai Calculator</h2>
                 <ul class="list-disc list-inside text-textlight space-y-2">
                     <li><strong>Data-Driven Decisions:</strong> Replace financial guesswork with clear, mathematical insights.</li>
                     <li><strong>Dual-Focus Strategy:</strong> Uniquely designed to help you manage debt and build wealth at the same time.</li>
                     <li><strong>Instant Visualizations:</strong> Powerful charts and graphs help you understand complex financial scenarios at a glance.</li>
                     <li><strong>Free and Easy to Use:</strong> No sign-ups, no fees. Just a powerful tool to help you achieve your financial goals.</li>
                 </ul>
             </div>

             <div>
                 <h2 class="text-[21px] font-normal text-textdark font-albert_sans mb-4">FAQs</h2>
                 <div class="space-y-4">
                     <div class="faq-item">
                         <div class="faq-question cursor-pointer flex justify-between items-center">
                             <h3 class="font-normal text-textdark">What sort of loans can I use the EMI calculator for?</h3>
                             <svg class="chevron w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                         </div>
                         <div class="faq-answer mt-2 text-textlight">
                             <p>You can use the PaiFinance calculator for a variety of loans, including home loans, car loans, personal loans, education loans, and loans against property. The tool is flexible enough to handle any type of loan that has a fixed interest rate and tenure.</p>
                         </div>
                     </div>
                     <div class="faq-item">
                         <div class="faq-question cursor-pointer flex justify-between items-center">
                             <h3 class="font-normal text-textdark">How does the debt-to-income ratio affect my chances of availing of a loan?</h3>
                             <div class="chevron w-4 h-4 transition-transform">
                                 <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                             </div>
                         </div>
                         <div class="faq-answer mt-2 text-textlight">
                             <p>Your debt-to-income (DTI) ratio is a key factor that lenders use to assess your ability to repay a loan. A lower DTI ratio indicates that you have a good balance between your debt and income, which can improve your chances of getting approved for a loan with favorable terms.</p>
                         </div>
                     </div>
                     <div class="faq-item">
                         <div class="faq-question cursor-pointer flex justify-between items-center">
                             <h3 class="font-normal text-textdark">What does an EMI consist of?</h3>
                             <div class="chevron w-4 h-4 transition-transform">
                                 <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                             </div>
                         </div>
                         <div class="faq-answer mt-2 text-textlight">
                             <p>An Equated Monthly Installment (EMI) consists of two main components: the principal amount and the interest. In the initial years of your loan, a larger portion of your EMI goes towards paying off the interest. As the loan matures, a larger portion goes towards paying down the principal.</p>
                         </div>
                     </div>
                     <div class="faq-item">
                         <div class="faq-question cursor-pointer flex justify-between items-center">
                             <h3 class="font-normal text-textdark">What happens if I fail to pay my EMIs?</h3>
                             <div class="chevron w-4 h-4 transition-transform">
                                 <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                             </div>
                         </div>
                         <div class="faq-answer mt-2 text-textlight">
                             <p>Failing to pay your EMIs on time can have serious consequences. It can negatively impact your credit score, making it difficult to get loans in the future. Lenders may also charge penalties and, in the case of secured loans like a car or home loan, they can repossess the asset.</p>
                         </div>
                     </div>
                     <div class="faq-item">
                         <div class="faq-question cursor-pointer flex justify-between items-center">
                             <h3 class="font-normal text-textdark">Is this calculator free to use?</h3>
                             <svg class="chevron w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                         </div>
                         <div class="faq-answer mt-2 text-textlight">
                             <p>Yes, the PaiFinance calculator is 100% free to use.</p>
                         </div>
                     </div>
                     <div class="faq-item">
                         <div class="faq-question cursor-pointer flex justify-between items-center">
                             <h3 class="font-normal text-textdark">Are the investment returns guaranteed?</h3>
                             <div class="chevron w-4 h-4 transition-transform">
                                 <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                             </div>
                         </div>
                         <div class="faq-answer mt-2 text-textlight">
                             <p>No. Investment returns are subject to market risks and are not guaranteed. The projections are based on the expected rate of return you provide.</p>
                         </div>
                     </div>
                 </div>
             </div>

         </div>
     </section>



     <!-- Blog Carousel Section -->
     <section class="bg-background py-12">
         <div class="max-w-7xl mx-auto px-6">
             <h2 class="text-[21px] font-normal text-textdark font-albert_sans mb-6">From the Blog</h2>
             <div class="flex space-x-8 overflow-x-auto pb-4">
                 <!-- Blog Post 1 -->
                 <div class="flex-shrink-0 w-80 bg-card rounded-lg shadow-md overflow-hidden">
                     <img src="img1.jpg" alt="Blog post image" class="w-full h-40 object-cover">
                     <div class="p-4">
                         <h3 class="font-bold text-lg mb-2">The 1% Loan Strategy</h3>
                         <p class="text-textlight text-sm mb-4">Discover the disciplined approach that turns your monthly budget into a powerful, dual-purpose tool.</p>
                         <a href="blog1cent.html" class="text-investment_green font-semibold hover:underline">Read More &rarr;</a>
                     </div>
                 </div>
                 <!-- Blog Post 2 -->
                 <div class="flex-shrink-0 w-80 bg-card rounded-lg shadow-md overflow-hidden">
                     <img src="img3.png" alt="Blog post image" class="w-full h-40 object-cover">
                     <div class="p-4">
                         <h3 class="font-bold text-lg mb-2">Take a Loan at 0% effective ROI</h3>
                         <p class="text-textlight text-sm mb-4">With the right strategy, discipline, and tools, your loan can pay for itself. Here’s how.</p>
                         <a href="blog20cent.html" class="text-investment_green font-semibold hover:underline">Read More &rarr;</a>
                     </div>
                 </div>
             </div>
         </div>
     </section>

     
     <!-- Footer -->
     <footer class="bg-textdark text-gray-300 py-8 px-6 md:px-12">
         <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8">
             <div>
                 <div class="flex items-center mb-4">
                     <img src="loogo.svg" alt="Pai Logo" class="h-8 w-auto">
                     <h2 class="text-xl font-bold ml-4">Pai Finance</h2>
                 </div>
                 <p class="text-sm">AX Building, Sector-23, Gurgaon, 122017</p>
             </div> 
             <div>
                 <h3 class="font-semibold mb-4">Contact Us</h3>
                 <p class="text-sm">paifinance.ai@gmail.com</p>
             </div>
             <div>
                 <h3 class="font-semibold mb-4">Legal</h3>
                 <ul class="space-y-2 text-sm">
                     <li><a href="#" class="hover:underline">Privacy Policy</a></li>
                     <li><a href="#" class="hover:underline">Terms & Conditions</a></li>
                 </ul>
             </div>
         </div>
     </footer>

     <!-- NEW: Warning Toast -->
    <div id="warningToast" class="hidden fixed bottom-5 right-5 bg-danger text-white py-3 px-5 rounded-lg shadow-lg text-sm opacity-0 transition-opacity duration-300 z-50">
        <span id="warningMessage"></span>
    </div>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const faqItems = document.querySelectorAll('.faq-item');
            faqItems.forEach(item => {
                const question = item.querySelector('.faq-question');
                const answer = item.querySelector('.faq-answer');
                question.addEventListener('click', () => {
                    answer.style.display = answer.style.display === 'block' ? 'none' : 'block';
                    question.classList.toggle('open');
                });
            });
        });

        // --- ONBOARDING SCRIPT ---
        const steps = [document.getElementById('step1'), document.getElementById('step2'), document.getElementById('step3')];
        const progressBar = document.getElementById('progressBar');
        const stepCounter = document.getElementById('stepCounter');
        const onboardingTitle = document.getElementById('onboardingTitle');
        const titles = ["Your Monthly Income", "Your Lifestyle", "Your Financial Horizon"];
        let currentStep = 1;
        let globalOnboardingData = {}; // To store data temporarily

        function showStep(stepNumber) {
            steps.forEach((step, index) => {
                step.classList.toggle('active', index + 1 === stepNumber);
            });
            const progress = (stepNumber / steps.length) * 100;
            progressBar.style.width = `${progress}%`;
            stepCounter.textContent = `Step ${stepNumber} of ${steps.length}`;
            onboardingTitle.textContent = titles[stepNumber - 1];
            currentStep = stepNumber;
        }

        function nextStep(stepNumber) {
            const inputs = steps[currentStep - 1].querySelectorAll('input');
            for (let input of inputs) {
                if (!input.value) {
                    input.focus();
                    input.classList.add('border-red-500');
                    return;
                }
                input.classList.remove('border-red-500');
            }
            if (stepNumber > steps.length) return;
            showStep(stepNumber);
        }

        function prevStep(stepNumber) {
            if (stepNumber < 1) return;
            showStep(stepNumber);
        }

        function finishOnboarding() {
            const inputs = steps[currentStep - 1].querySelectorAll('input');
            for (let input of inputs) {
                if (!input.value) {
                    input.focus();
                    input.classList.add('border-red-500');
                    return;
                }
            }

            // Store data globally to be used by the summary modal's button
            globalOnboardingData = {
                monthlyIncome: parseFloat(document.getElementById('ob_monthlyIncome').value),
                epfVpf: parseFloat(document.getElementById('ob_epfVpf').value),
                monthlyExpenses: parseFloat(document.getElementById('ob_monthlyExpenses').value),
                planningYears: parseInt(document.getElementById('ob_planningYears').value)
            };
            
            document.getElementById('onboardingModal').classList.add('hidden');
            document.getElementById('onboardingModal').classList.remove('flex');
            
            showSummaryAndCalculate(globalOnboardingData);
        }
        
        // --- PAGE INITIALIZATION SCRIPT ---
        document.addEventListener('DOMContentLoaded', () => {
            const onboardingTriggerIcon = document.getElementById('onboardingTriggerIcon');
            const onboardingModal = document.getElementById('onboardingModal');
            const summaryModal = document.getElementById('postOnboardingSummaryModal');
            const coachmark = document.getElementById('coachmark');
            const pulsingDot = document.getElementById('pulsingDot');
            const startPlanningBtn = document.getElementById('startPlanningBtn');
            const closeOnboardingModalBtn = document.getElementById('closeOnboardingModal');
            const closeSummaryModalBtn = document.getElementById('closeSummaryModal');

            pulsingDot.classList.add('animate-pulse-glow');
            
            setTimeout(() => {
                pulsingDot.classList.remove('animate-pulse-glow');
            }, 3000);

            setTimeout(() => {
                coachmark.style.display = 'none';
            }, 5000);

            onboardingTriggerIcon.addEventListener('click', () => {
                onboardingModal.classList.remove('hidden');
                onboardingModal.classList.add('flex');
                showStep(1);
            });
            
            startPlanningBtn.addEventListener('click', () => {
                summaryModal.classList.add('hidden');
                summaryModal.classList.remove('flex');
                populateCalculatorAndRun(globalOnboardingData);
            });

            closeOnboardingModalBtn.addEventListener('click', () => {
                onboardingModal.classList.add('hidden');
                onboardingModal.classList.remove('flex');
            });

            closeSummaryModalBtn.addEventListener('click', () => {
                summaryModal.classList.add('hidden');
                summaryModal.classList.remove('flex');
            });
        });
        
        // --- NEW: More Accurate Budget Calculation ---
        function calculateInHandBudget(data) {
            const annualGross = data.monthlyIncome * 12;
            const epfContribution = annualGross * (data.epfVpf / 100);
            
            // Assuming Old Tax Regime with standard deduction
            const standardDeduction = 50000;
            // Assuming EPF is under Section 80C, capped at 1.5 Lakhs
            const epfDeduction = Math.min(epfContribution, 150000);
            
            let taxableIncome = annualGross - standardDeduction - epfDeduction;
            
            let annualTax = 0;
            if (taxableIncome > 1000000) {
                annualTax = 112500 + (taxableIncome - 1000000) * 0.30;
            } else if (taxableIncome > 500000) {
                annualTax = 12500 + (taxableIncome - 500000) * 0.20;
            } else if (taxableIncome > 250000) {
                annualTax = (taxableIncome - 250000) * 0.05;
            }
            // Add 4% cess
            annualTax *= 1.04;

            const monthlyTax = annualTax / 12;
            const monthlyEpf = epfContribution / 12;
            
            const inHandMonthly = data.monthlyIncome - monthlyTax - monthlyEpf;
            const finalBudget = inHandMonthly - data.monthlyExpenses;

            return {
                gross: data.monthlyIncome,
                tax: Math.round(monthlyTax),
                epf: Math.round(monthlyEpf),
                inHand: Math.round(inHandMonthly),
                expenses: data.monthlyExpenses,
                finalBudget: Math.max(0, Math.round(finalBudget)),
                planningYears: data.planningYears
            };
        }

        function showSummaryAndCalculate(data) {
            console.log("Onboarding complete! Preparing summary with data:", data);
            
            const budgetDetails = calculateInHandBudget(data);

            // Populate summary modal
            document.getElementById('summaryGross').textContent = `₹${budgetDetails.gross.toLocaleString('en-IN')}`;
            document.getElementById('summaryTax').textContent = `- ₹${budgetDetails.tax.toLocaleString('en-IN')}`;
            document.getElementById('summaryEpf').textContent = `- ₹${budgetDetails.epf.toLocaleString('en-IN')}`;
            document.getElementById('summaryInHand').textContent = `₹${budgetDetails.inHand.toLocaleString('en-IN')}`;
            document.getElementById('summaryExpenses').textContent = `- ₹${budgetDetails.expenses.toLocaleString('en-IN')}`;
            document.getElementById('summaryBudget').textContent = `₹${budgetDetails.finalBudget.toLocaleString('en-IN')}`;
            
            // Show the modal
            const summaryModal = document.getElementById('postOnboardingSummaryModal');
            summaryModal.classList.remove('hidden');
            summaryModal.classList.add('flex');
        }

        function populateCalculatorAndRun(data) {
            const budgetDetails = calculateInHandBudget(data);
            
            // Create and dispatch a custom event with the calculated budget and tenure
            const event = new CustomEvent('onboardingComplete', { 
                detail: {
                    budget: budgetDetails.finalBudget,
                    tenure: budgetDetails.planningYears
                }
            });
            document.dispatchEvent(event);
        }

    </script>
    <script src="script.js"></script>
</body>
</html>

